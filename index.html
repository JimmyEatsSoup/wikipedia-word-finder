<script>
async function search() {
    const word = document.getElementById("word").value.trim();
    if (!word) return;

    const resultsDiv = document.getElementById("results");
    resultsDiv.innerHTML = "Searching...";

    // Search for pages containing the word
    const searchURL = `https://en.wikipedia.org/w/api.php?origin=*&action=query&list=search&srsearch=${encodeURIComponent(word)}&srlimit=10&format=json`;
    const searchData = await fetch(searchURL).then(r => r.json());

    resultsDiv.innerHTML = "";

    for (const page of searchData.query.search) {
        // Build the Wikipedia page URL
        const wikiURL = `https://en.wikipedia.org/wiki/${page.title.replace(/ /g, "_")}`;

        // Optional: fetch page extract to count occurrences
        const pageURL = `https://en.wikipedia.org/w/api.php?origin=*&action=query&prop=extracts&pageids=${page.pageid}&explaintext=1&format=json`;
        const pageData = await fetch(pageURL).then(r => r.json());
        const text = Object.values(pageData.query.pages)[0].extract || "";
        const regex = new RegExp(`\\b${word}\\b`, "gi");
        const count = (text.match(regex) || []).length;

        // Create result div with clickable link
        const div = document.createElement("div");
        div.className = "result";
        div.innerHTML = `<a href="${wikiURL}" target="_blank"><strong>${page.title}</strong></a><br>Occurrences: ${count}`;
        resultsDiv.appendChild(div);
    }
}
</script>
