<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Wikipedia Random Word Finder</title>
<style>
body {
    font-family: Arial, sans-serif;
    background: #111;
    color: #eee;
    padding: 20px;
}
input, button {
    padding: 10px;
    font-size: 16px;
    margin-right: 5px;
}
button {
    cursor: pointer;
}
.result {
    background: #1e1e1e;
    padding: 10px;
    margin-top: 10px;
    border-radius: 5px;
}
a {
    color: #4da6ff;
    text-decoration: none;
}
a:hover {
    text-decoration: underline;
}
</style>
</head>
<body>

<h1>Wikipedia Random Word Finder</h1>
<p>Type a word to get random Wikipedia pages containing it. Use Refresh to see new pages.</p>

<input id="word" placeholder="Enter a word">
<button onclick="search()">Search</button>
<button onclick="refresh()">Refresh</button>

<div id="results"></div>

<script>
let currentResults = [];
let currentWord = "";

function getRandomSubset(array, count) {
    // Shuffle array and take 'count' items
    const shuffled = array.sort(() => 0.5 - Math.random());
    return shuffled.slice(0, count);
}

async function search() {
    const word = document.getElementById("word").value.trim();
    if (!word) return;

    currentWord = word;
    const resultsDiv = document.getElementById("results");
    resultsDiv.innerHTML = "Searching...";

    try {
        // Fetch up to 50 search results for the word
        const searchURL = `https://en.wikipedia.org/w/api.php?origin=*&action=query&list=search&srsearch=${encodeURIComponent(word)}&srwhat=text&srlimit=50&format=json`;
        const searchData = await fetch(searchURL).then(r => r.json());

        if (!searchData.query || !searchData.query.search.length) {
            resultsDiv.innerHTML = `No pages found containing the word "${word}".`;
            return;
        }

        // Store all results for refresh
        currentResults = searchData.query.search;

        displayRandomResults();
    } catch (error) {
        resultsDiv.innerHTML = "Error fetching results. Check console.";
        console.error(error);
    }
}

async function displayRandomResults() {
    const resultsDiv = document.getElementById("results");
    resultsDiv.innerHTML = "";

    // Pick 10 random results
    const randomPages = getRandomSubset(currentResults, 10);

    for (const page of randomPages) {
        const pageURL = `https://en.wikipedia.org/wiki/${page.title.replace(/ /g, "_")}`;
        const div = document.createElement("div");
        div.className = "result";
        div.innerHTML = `<a href="${pageURL}" target="_blank"><strong>${page.title}</strong></a>`;
        resultsDiv.appendChild(div);
    }
}

function refresh() {
    if (!currentResults.length) return;
    displayRandomResults();
}
</script>

</body>
</html>
